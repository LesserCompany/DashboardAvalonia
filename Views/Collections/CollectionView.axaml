<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="750"
             xmlns:vm="clr-namespace:LesserDashboardClient.ViewModels.Collections"
             xmlns:local="clr-namespace:LesserDashboardClient.Views.Collections"
             x:DataType="vm:CollectionsViewModel"
             xmlns:ui="clr-namespace:FluentAvalonia.UI.Controls;assembly=FluentAvalonia.ProgressRing"
             xmlns:custonControls="clr-namespace:LesserDashboardClient"
             x:Class="LesserDashboardClient.Views.Collections.CollectionView"
             Focusable="False"
             >
    <UserControl.Resources>
        <x:Double x:Key="DefaultRowSpacing">6</x:Double>
    </UserControl.Resources>
    <ScrollViewer>
      <Grid RowDefinitions="*, Auto" Margin="10">
        <!--Loading ...-->
        <!--
        <Grid Grid.Row="0" IsVisible="{Binding IsUpdateProgressBars}">
          <StackPanel Spacing="6" VerticalAlignment="Center" HorizontalAlignment="Stretch">
            <ui:ProgressRing BorderThickness="5" IsIndeterminate="True" Width="28" Height="28" />
            <TextBlock Text="{Tr 'Loading selected collection ...'}" TextAlignment="Center" />
          </StackPanel>
        </Grid>
        -->
        
        <!--Content-->
        <StackPanel Grid.Row="0" Margin="0 50 0 0"  Spacing="{DynamicResource DefaultRowSpacing}">
          <TextBlock Text="{Tr 'Canceled'}" FontSize="18" TextAlignment="Center" Foreground="Red" IsVisible="{Binding SelectedCollectionIsCanceled}" />
          <Grid RowDefinitions="80" ColumnDefinitions="200, * " Grid.Row="0" >
                <local:ProfessionalRepresentation Grid.Column="0"   ProfessionalName="{Binding SelectedCollection.professionalLogin}" VerticalAlignment="Center" HorizontalAlignment="Center" />
                <SelectableTextBlock Grid.Column="1" VerticalAlignment="Center" FontSize="18" HorizontalAlignment="Center" Text="{Binding SelectedCollection.classCode}"></SelectableTextBlock>
          </Grid>
          
          <TextBlock Grid.Row="1" IsVisible="{Binding !UploadComplete}" TextWrapping="Wrap" TextAlignment="Center" Text="{Tr 'Upload incomplete ...'}" />
            
          <SelectableTextBlock Grid.Row="2" VerticalAlignment="Center" HorizontalAlignment="Center" Text="{Binding SelectedCollection.originalEventsFolder}" />
          <!-- ProgressBars -->
          <Grid Grid.Row="3" RowDefinitions="Auto, Auto, Auto" ColumnDefinitions="200, *" ColumnSpacing="5" RowSpacing="{DynamicResource DefaultRowSpacing}">
              <!-- Row 1 -->
              <TextBlock Grid.Row="0"  VerticalAlignment="Center" HorizontalAlignment="Right" Grid.Column="0" Text="{Tr 'Recognition on the server:'}" />
              <ProgressBar  IsVisible="{Binding !IsUpdateProgressBars}" Grid.Row="0" Maximum="{Binding TotalPhotosForRecognition}" Value="{Binding TotalPhotosForRecognitionDone}" Grid.Column="1" Height="35"  ShowProgressText="True" ProgressTextFormat="{}{0}/{3} - ({1:0}%)" VerticalAlignment="Center" HorizontalAlignment="Stretch" />

              <!-- Row 2 -->
              <Grid Grid.Row="1" Grid.Column="0"  Grid.ColumnSpan="2" IsVisible="{Binding SelectedCollection.AutoTreatment, FallbackValue=False}" ColumnSpacing="5" RowDefinitions="Auto" ColumnDefinitions="200, *" HorizontalAlignment="Stretch">
                <TextBlock Grid.Row="0" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Right"  Text="{Tr 'Enhancement on the server:'}" />
                <ProgressBar  IsVisible="{Binding !IsUpdateProgressBars}" Grid.Row="0" Grid.Column="1" Maximum="{Binding TotalPhotosForAutoTreatment}" Value="{Binding TotalPhotosForAutoTreatmentDone}" Height="35" ShowProgressText="True" ProgressTextFormat="{}{0}/{3} - ({1:0}%)" VerticalAlignment="Center" HorizontalAlignment="Stretch" />
              </Grid>

              <!-- Row 3 -->
              <Grid Grid.Row="2" Grid.Column="0"  Grid.ColumnSpan="2" IsVisible="{Binding SelectedCollection.OCR, FallbackValue=False}" ColumnSpacing="5" RowDefinitions="Auto" ColumnDefinitions="200, *" HorizontalAlignment="Stretch">
                <TextBlock Grid.Row="0" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Right"  Text="{Tr 'OCR on the server:'}" />
                <ProgressBar  IsVisible="{Binding !IsUpdateProgressBars}" Grid.Row="0" Grid.Column="1" Maximum="{Binding TotalPhotosForOCR}" Value="{Binding TotalPhotosForOCRDone}" Height="35" ShowProgressText="True" ProgressTextFormat="{}{0}/{3} - ({1:0}%)" VerticalAlignment="Center" HorizontalAlignment="Stretch" />
              </Grid>
          </Grid>
            
            <!-- SeparationFiles -->
          <Grid Grid.Row="4" RowDefinitions="Auto, Auto" RowSpacing="6" Margin="4" IsVisible="{Binding ClassSeparationFilesIsVisible}">
            <TextBlock Grid.Row="0" Text="{Tr 'Choose the separation file you want to work with:'}" FontSize="12" />
            
            <ListBox Grid.Row="1" BorderBrush="Black" BorderThickness="0.6"  x:Name="ListBox" ItemsSource="{Binding ClassSeparationFiles}" SelectedItem="{Binding SelectedSeparationFile}" FontSize="11" >
              <ListBox.ItemTemplate>
                <DataTemplate>
                  <StackPanel Orientation="Horizontal">
                    <Label  Content="{Tr 'User:'}" />
                    <Label Width="100" Content="{Binding Creator}"></Label>
                    <Label Content="{Tr 'Local:'}" Margin="20,0,0,0" />
                    <Label Width="70" Content="{Binding FileLocationType}"></Label>
                    <Label Content="{Tr 'Last modified date:'}" Margin="20,0,0,0" />
                    <Label Content="{Binding HumanReadableModificationDate}"></Label>
                  </StackPanel>
                </DataTemplate>
              </ListBox.ItemTemplate>
            </ListBox>  
          </Grid>
          
          
            
          <!-- Buttons -->
          <Grid ColumnDefinitions="1*, 1*, 1*, 1*" Grid.Row="5" ColumnSpacing="5">
            <Button IsEnabled="{Binding BtTagSortIsEnabled}" Command="{Binding TagSortCommand}" IsVisible="{Binding ActionsButtonsIsVisible}" Height="45" Grid.Column="0" HorizontalAlignment="Stretch" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" >
              <StackPanel Orientation="Horizontal" Spacing="2" VerticalAlignment="Center" HorizontalAlignment="Center">
                <TextBlock Text="{Tr 'Tag/Sort'}" VerticalAlignment="Center" />
                <ui:ProgressRing IsVisible="{Binding BtTagSortIsRunning}" VerticalAlignment="Center" BorderThickness="5" IsIndeterminate="True" Width="10" Height="10" />
              </StackPanel>
            </Button>
            <Button IsEnabled="{Binding BtExportIsEnabled}" Command="{Binding ExportCommand}" IsVisible="{Binding ActionsButtonsIsVisible}" Height="45" Grid.Column="1" HorizontalAlignment="Stretch" HorizontalContentAlignment="Center" VerticalContentAlignment="Center">
              <StackPanel Orientation="Horizontal" Spacing="2" VerticalAlignment="Center" HorizontalAlignment="Center">
                <TextBlock Text="{Tr 'Export'}" VerticalAlignment="Center" />
                <ui:ProgressRing IsVisible="{Binding BtExportIsRunning}" VerticalAlignment="Center" BorderThickness="5" IsIndeterminate="True" Width="10" Height="10" />
              </StackPanel>
            </Button>
            <Button IsEnabled="{Binding BtExportIsEnabled}" Command="{Binding ToggleViewReportsContainer}" IsVisible="{Binding ActionsButtonsIsVisible}" Height="45" Grid.Column="2" HorizontalAlignment="Stretch" HorizontalContentAlignment="Center" VerticalContentAlignment="Center">
              <StackPanel Orientation="Horizontal" Spacing="2" VerticalAlignment="Center" HorizontalAlignment="Center">
                <TextBlock Text="{Tr 'Reports'}" VerticalAlignment="Center" />
              </StackPanel>
            </Button>
            <Button IsEnabled="{Binding BtDownloadHdIsEnabled}" Command="{Binding DownloadHDCommand}" Height="45" Grid.Column="3" HorizontalAlignment="Stretch" HorizontalContentAlignment="Center" VerticalContentAlignment="Center">
              <StackPanel Orientation="Horizontal" Spacing="2" VerticalAlignment="Center" HorizontalAlignment="Center">
                <TextBlock Text="{Tr 'Download Backup HD'}" VerticalAlignment="Center" />
                <ui:ProgressRing IsVisible="{Binding BtDownloadHdIsRunning}" VerticalAlignment="Center" BorderThickness="5" IsIndeterminate="True" Width="10" Height="10" />
              </StackPanel>
            </Button>
          </Grid>

          <!-- REPORTS CONTAINER -->
          <Grid ColumnDefinitions="1*, 1*" IsVisible="{Binding ReportsContainerIsVisible}" ColumnSpacing="4">
            <Button Command="{Binding GeneralReportCommand}" Height="45" Grid.Column="0" HorizontalAlignment="Stretch" HorizontalContentAlignment="Center" VerticalContentAlignment="Center">
              <StackPanel Orientation="Horizontal" Spacing="2" VerticalAlignment="Center" HorizontalAlignment="Center">
                <TextBlock VerticalAlignment="Center" >
                  <Run Text="📋" />
                  <Run Text="{Tr 'General Report'}" />
                </TextBlock>
                <ui:ProgressRing IsVisible="{Binding GeneratingGeneralReport}" VerticalAlignment="Center" BorderThickness="5" IsIndeterminate="True" Width="10" Height="10" />
              </StackPanel>
            </Button>

            <Button Command="{Binding ReportPerGraduatesCommand}" Height="45" Grid.Column="1" HorizontalAlignment="Stretch" HorizontalContentAlignment="Center" VerticalContentAlignment="Center">
              <StackPanel Orientation="Horizontal" Spacing="2" VerticalAlignment="Center" HorizontalAlignment="Center">
                <TextBlock  VerticalAlignment="Center" >
                  <Run Text="👨‍🎓" />
                  <Run Text="{Tr 'General per Graduate'}" />
                </TextBlock>
                <ui:ProgressRing IsVisible="{Binding GeneratingReportPerGraduate}" VerticalAlignment="Center" BorderThickness="5" IsIndeterminate="True" Width="10" Height="10" />
              </StackPanel>
            </Button>
          </Grid>


          <!-- Resume SeparationFile -->
          <local:ResumeSeparationFile IsVisible="{Binding ResumeSeparationFileComponentIsVisible}" />
            
          <Grid Grid.Row="6">
              <Expander Header="{Tr 'Advanced'}" HorizontalAlignment="Stretch" IsEnabled="{Binding !SelectedCollection.BillingCancelled}" >
                  <StackPanel Spacing="6">
                      <Button Width="325" Command="{Binding OpenReuploadViewCommand}">
                          <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center" Orientation="Horizontal" Spacing="4">
                              <TextBlock Text="{Tr 'Reupload'}" VerticalAlignment="Center" />
                              <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE9CE;" VerticalAlignment="Center" ToolTip.Tip="{Tr 'Reupload the class to the server'}"  />
                          </StackPanel>
                      </Button>
                      <Button Width="325" Command="{Binding ReEnqueueCommand}" IsEnabled="{Binding BtReEnqueueIsEnabled}" >
                          <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center" Orientation="Horizontal" Spacing="4">
                            <TextBlock Text="{Tr 'Recognize again'}" VerticalAlignment="Center" />
                            <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE9CE;" VerticalAlignment="Center" ToolTip.Tip="{Tr 'The photos will be re-queued for facial recognition'}"  />
                            <ui:ProgressRing IsVisible="{Binding BtReenqueueIsRunning}" VerticalAlignment="Center" BorderThickness="5" IsIndeterminate="True" Width="10" Height="10" />
                          </StackPanel>
                      </Button>
                      <Button Width="325" IsEnabled="{Binding BtRequestManualTreatmentAllCollectionIsEnabled}" Command="{Binding RequestManualTreatmentAllCollectionCommand}">
                          <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center" Orientation="Horizontal" Spacing="4">
                            <TextBlock Text="{Tr 'Request treatment of the entire collection'}" VerticalAlignment="Center" />
                            <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE9CE;" VerticalAlignment="Center" ToolTip.Tip=""  />
                            <ui:ProgressRing IsVisible="{Binding BtRequestManualTreatmentAllCollectionIsRunning}" VerticalAlignment="Center" BorderThickness="5" IsIndeterminate="True" Width="10" Height="10" />
                          </StackPanel>
                      </Button>
                      <Button Width="325" Command="{Binding OpenCancelBillingViewCommand}">
                          <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center" Orientation="Horizontal" Spacing="4">
                              <TextBlock Text="{Tr 'Cancel billing'}" VerticalAlignment="Center" />
                              <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE9CE;" VerticalAlignment="Center" ToolTip.Tip=""  />
                          </StackPanel>
                      </Button>
                  </StackPanel>
              </Expander>
          </Grid>
        </StackPanel>
        <Grid Grid.Row="1" IsVisible="{Binding IsUpdateProgressBars}" VerticalAlignment="Bottom" HorizontalAlignment="Right">
          <StackPanel Orientation="Horizontal" Spacing="6" VerticalAlignment="Center" HorizontalAlignment="Stretch">
            <ui:ProgressRing BorderThickness="5" IsIndeterminate="True" VerticalAlignment="Center" Width="10" Height="10" />
            <TextBlock FontSize="11" Text="{Tr 'Loading selected collection ...'}" TextAlignment="Center" VerticalAlignment="Center" />
          </StackPanel>
        </Grid>
      </Grid>
    </ScrollViewer>
</UserControl>

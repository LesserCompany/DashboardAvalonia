<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:LesserDashboardClient.ViewModels"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:TabCollections="clr-namespace:LesserDashboardClient.Views.Collections"
        xmlns:TabOptions="clr-namespace:LesserDashboardClient.Views.Options"
        xmlns:TabInvoices="clr-namespace:LesserDashboardClient.Views.Invoices"
        xmlns:TabSearchGraduate="clr-namespace:LesserDashboardClient.Views.SearchGraduate"
        xmlns:local="clr-namespace:LesserDashboardClient.Views"
        xmlns:ui="clr-namespace:FluentAvalonia.UI.Controls;assembly=FluentAvalonia.ProgressRing"
        mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
        x:Class="LesserDashboardClient.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Title="{Binding TitleApp}"
        ExtendClientAreaToDecorationsHint="false"
        WindowStartupLocation="CenterScreen"
        MinWidth="900"
        >

    <Design.DataContext>
        <!-- This only sets the DataContext for the previewer in an IDE,
             to set the actual DataContext for runtime, set the DataContext property in code (look at App.axaml.cs) -->
        <vm:MainWindowViewModel/>
    </Design.DataContext>
    <Window.Resources>
        <x:Double  x:Key="FontSizeHeaderTabs">14</x:Double>
        <Thickness x:Key="MarginContent">25</Thickness>
    </Window.Resources>
    
    
    <!--TEMPLATE -->
    <Grid RowDefinitions="Auto, *">
        <Grid Grid.Row="0">
          <!--SomeOne Content ... -->
        </Grid>
      
        <Grid Grid.Row="1" RowDefinitions="Auto, *, Auto" >
            <!-- Top -->
            <Grid Grid.Row="0" ColumnDefinitions="*, Auto">
                <!--content top -->
            </Grid>

            <!-- Content -->
            <Border Grid.Row="1" Margin="{DynamicResource MarginContent}">
              <Grid>
                <TabControl VerticalAlignment="Stretch">
                    <TabItem Header="{Tr 'Collections'}" FontSize="{DynamicResource FontSizeHeaderTabs}">
                      <TabCollections:CollectionsControl />
                    </TabItem>
                    
                    <TabItem Header="{Tr 'Diagramar'}" FontSize="{DynamicResource FontSizeHeaderTabs}">
                      <TabItem.ContentTemplate>
                        <DataTemplate>
                          <local:DiagramationControl x:CompileBindings="True" x:Name="DiagramationTab" IsVisible="True" />
                        </DataTemplate>
                      </TabItem.ContentTemplate>
                    </TabItem>
                    
                    <TabItem Header="{Tr 'User per CPF'}" FontSize="{DynamicResource FontSizeHeaderTabs}">
                      <TabItem.ContentTemplate>
                        <DataTemplate>
                          <TabSearchGraduate:SearchGraduateControl x:CompileBindings="True" x:Name="SearchGraduateTab" IsVisible="True" />
                        </DataTemplate>
                      </TabItem.ContentTemplate>
                    </TabItem>
                    
                    <TabItem Header="{Tr 'Invoices'}" FontSize="{DynamicResource FontSizeHeaderTabs}">
                      <TabItem.ContentTemplate>
                        <DataTemplate>
                          <TabInvoices:InvoicesControl x:CompileBindings="True" x:Name="InvoicesTab" IsVisible="True" />
                        </DataTemplate>
                      </TabItem.ContentTemplate>
                    </TabItem>
                    
                    <TabItem Header="{Tr 'Options'}" FontSize="{DynamicResource FontSizeHeaderTabs}">
                      <TabOptions:OptionsControl />
                    </TabItem>
                </TabControl>
                <local:LogoutComponent Grid.Column="2" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="4" />
              </Grid>
            </Border>

            <!-- Footer -->
            <Grid  Grid.Row="2" RowDefinitions="Auto, Auto" Background="{DynamicResource SystemControlBackgroundListMediumBrush}">
              <Grid Grid.Row="0" ColumnDefinitions="Auto, *, Auto">
                <!-- Coluna 0: Voltar para versão anterior -->
                <StackPanel Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="4" Orientation="Horizontal">
                  <local:AppVersionControl  />
                  <Button Margin="4 0 0 0" Background="{DynamicResource SystemChromeBlackMediumLowColor}" Command="{Binding GoBackToPreviousVersionCommand}">
                    <StackPanel Orientation="Horizontal" Spacing="4" >
                      <Svg Path="/Assets/icons/arrow-back.svg" Width="12" Height="12" VerticalAlignment="Center" />
                      <TextBlock FontSize="10" Foreground="White" Text="{Tr 'Go back to previous version'}" VerticalAlignment="Center" />
                    </StackPanel>
                  </Button>
                </StackPanel>
                  
                <!-- Coluna 1: CarregandoEndpoints (Centralizado) -->
                <StackPanel Grid.Column="1"
                           Orientation="Horizontal" 
                           Spacing="4" 
                           VerticalAlignment="Center"
                           HorizontalAlignment="Center">
                  <StackPanel IsVisible="{Binding IsLoadingEndpointsInfo}" 
                             Orientation="Horizontal" 
                             Spacing="4" 
                             VerticalAlignment="Center">
                    <ui:ProgressRing IsIndeterminate="True" 
                                    BorderThickness="2" 
                                    Width="12" 
                                    Height="12" 
                                    VerticalAlignment="Center" />
                    <TextBlock Text="Carregando informações dos endpoints..." 
                              FontSize="12" 
                              VerticalAlignment="Center"
                              Foreground="{DynamicResource TextFillColorSecondaryBrush}" />
                  </StackPanel>
                </StackPanel>
                
                <!-- Coluna 2: Está com problemas? | Botão Suporte (Direita) -->
                <StackPanel Grid.Column="2" 
                           VerticalAlignment="Center" 
                           HorizontalAlignment="Right"
                           Margin="4"
                           Orientation="Horizontal"
                           Spacing="4">
                  <TextBlock FontSize="11" 
                            Text="{Tr 'Having problems?'}" 
                            Margin="0 0 4 0" 
                            FontWeight="SemiBold" 
                            VerticalAlignment="Center" />
                  <Button Height="25" 
                         HorizontalAlignment="Center" 
                         Background="{DynamicResource SystemChromeBlackMediumLowColor}" 
                         Command="{Binding OpenWhatsAppSuportCommand}">
                    <StackPanel Orientation="Horizontal">
                      <TextBlock Text="{Tr 'Support'}" 
                                FontSize="11" 
                                Foreground="White" 
                                VerticalAlignment="Center" 
                                Margin="2 0" />
                      <Grid Width="20" Height="20">
                        <Ellipse Fill="{DynamicResource SystemControlBackgroundAccentBrush}" />
                        <Svg Path="/Assets/icons/whatsapp-white.svg" 
                             Width="11" 
                             Height="11" 
                             VerticalAlignment="Center" 
                             HorizontalAlignment="Center"/>
                      </Grid>
                    </StackPanel>
                  </Button>
                </StackPanel>
              </Grid>  
              <local:UpdateAppProgressBarControl Grid.Row="1" IsVisible="{Binding IsUpdateSomeOneComponent}" />
            </Grid>
        </Grid>
    </Grid>
</Window>
